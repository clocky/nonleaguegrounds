---
layout: base.njk
pagination:
    data: leagues
    size: 1
    alias: league
permalink: "league/{{ league.name | slugify }}/index.html"
eleventyComputed:
    title: "Clubs in the {{ league.sponsor | safe }} {{ league.name | safe }}"
    description: The {{ league.sponsor }} {{ league.name }} is the {{ league.tier | ordinal }} tier of the English football pyramid, with a total of {{ league.clubs.length }} clubs"
---
{% from "macros.njk" import emoji %}

{%- set markers -%}
{%- for club in league.clubs -%}
    {%- for c in clubs -%}
        {%- if c.name == club.name -%}
            {%- for g in grounds -%}
                {%- if c.ground == g.name -%}
                    &markers=size:mid|label:{{club.name.slice(0,1) | upper }}|{{ g.latitude }},{{ g.longitude }}
                {%- endif -%}
            {%- endfor -%}
        {%- endif -%}
    {%- endfor -%}
{%- endfor -%}
{%- endset -%}
{%- set key = env.google_maps_api_key -%}

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SportsOrganization",
        "name": "{{ league.name }}",
        "alternateName": "{{ league.sponsor }} {{ league.name }}",
        "sponsor": {
            "@type": "Organization",
            "name": "{{ league.sponsor }}"
        },
        "url": "https://{{ league.url }}",
        "identifier": {
            "@type": "url",
            "@value": "{{ meta.base }}/league/{{ league.name | slugify }}"
        },    
    }
</script>

<header class="container-fluid hero" id="league" data-theme="dark">
    <div class="container">
        <h1>{{ league.sponsor }} {{ league.name }}</h1>
        <div class="grid">
            <p><strong>The {{ league.name }} is at the {{ league.tier | ordinal }} tier of the
                English football pyramid, with a total of
                {{ league.clubs.length }} clubs</strong></p>
            <p></p>
        </div>
    </div>
</header>


<main class="container">
    <div class="row">
        {% for club in league.clubs %}
            <div class="col-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">{{ club.name }}</h5>
                        <h6 class="card-subtitle mb-2 text-muted">{{ club.nickname }}</h6>
                        <a href="/club/{{ club.name | slugify }}/" class="card-link">More</a>
                        <a href="#" class="card-link">Another link</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="row">
        <div class="col-8">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Club</th>
                        <th scope="col">Nickname</th>
                    </tr>
                </thead>
                <tbody>
                    {% for club in league.clubs %}
                        <tr>
                            <th>
                                <a href="/club/{{ club.name | slugify }}">{{ club.name }}</a>
                            </th>
                            {% for c in clubs %}
                                {% if c.name == club.name %}
                                    <td>
                                        {% if c.nickname %}
                                        <span class="emoji">{{ emoji(c.nickname) }}</span> {{ c.nickname }}
                                        {% endif %}
                                    </td>
                                {% endif %}
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-4">
            <figure>
                {% set caption = "Map of " + league.name + " clubs" %}
                <img 
                    class="figure-img img-fluid"
                    src="https://maps.googleapis.com/maps/api/staticmap?size=640x640&scale=1&markers={{ markers }}&key={{key}}" 
                    alt="{{ caption }}"
                >
                <figcaption class="figure-caption">
                   {{ caption }}
                </figcaption>
            </figure>
        </div>
    </div>
    <footer>
        <small>
        Photo by <a href="https://unsplash.com/@fkaregan?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Samuel Regan-Asante</a> on <a href="https://unsplash.com/s/photos/non-league?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>
        </small>
    </footer>
</main>