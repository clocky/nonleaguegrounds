---
pagination:
    data: clubs
    size: 1
    alias: club
permalink: "/leagues/{{ club.memberOf.name | slugify }}/{{ club.name | slugify }}/index.html"
eleventyComputed:
    title: "{{ club.name | safe }} | {{ meta.title }}"
    description: "Information about {{ club.name }}, a {{club.keywords}} football club."
---
{% extends "./_layouts/base.njk" %}

{% from "aerial.macro.njk" import aerial %}
{% from "breadcrumb.macro.njk" import breadcrumb %}
{% from "creative-commons.macro.njk" import creativeCommons %}
{% from "macros.njk" import staticmap %}

{% block link %}
  <link rel="canonical" href="{{ meta.base }}/leagues/{{ club.memberOf.name | slugify }}/{{ club.name | slugify }}">
{% endblock %}

{% block script %}
  <script type="application/ld+json">
    {{ club | dump | safe }}
  </script>
  <script>
    {%- for url in club.sameAs %}
      {%- if "youtube" in url and "channel" in url %}
        async function loadVideo(iframe) {
            {% set cid = url.split("/")[4] %}
            {% set channelUrl = "https://www.youtube.com/feeds/videos.xml?channel_id=" + cid | urlencode %}
            const url = "https://api.rss2json.com/v1/api.json?rss_url={{ channelUrl }}";
            const response = await fetch(url)
            const result = await response.json()
            const link = result.items[0].link;
            const id = link.substring(link.indexOf("=") + 1); 
            iframe.setAttribute("src", `https://youtube.com/embed/${id}?controls=0&autoplay=1`);
        }
        window.onload = function() {
          loadVideo(document.getElementById("youtube"))
        }
      {%- endif %}
    {%- endfor %}
  </script>
{% endblock %}

{% block css %}
  {%- if club.owns %}
    {%- if not club.image %}
      <style>
        section.hero {
          background: linear-gradient(135deg, {%- if club.owns.color.length == 2 %} {{ club.owns.color[0] }} 0%, {{ club.owns.color[0] }} 10.5rem, {{ club.owns.color[1] }} 10.51rem, {{ club.owns.color[1] }} 15rem, {{ club.owns.color[0] }} 15.01rem, {{ club.owns.color[0] }} 15.50rem, #ffffff 15.51rem, #ffffff 100% {%- elif club.owns.color.length == 3 %} {{ club.owns.color[0] }} 0%, {{ club.owns.color[0] }} 10.5rem, {{ club.owns.color[1] }} 10.51rem, {{ club.owns.color[1] }} 15rem, {{ club.owns.color[2] }} 15.01rem, {{ club.owns.color[2] }} 15.50rem, #ffffff 15.51rem, #ffffff 100% {%- else %} {{ club.owns.color[0] }} 0%, {{ club.owns.color[0] }} 15.5rem, #ffffff 15.51rem, #ffffff 100% {%- endif %});
        }
      </style>
    {%- endif %}
  {%- endif %}
{% endblock %}

{% block breadcrumb %}
  {{- breadcrumb("Leagues", club.memberOf.name, club.name) }}
{% endblock %}

{% block header %}
  <section class="hero {% if club.owns === false %}is-white{% endif %} {% if club.image %}is-fullheight{% endif %} has-background">
    {% if club.image %}
      {# 640, 768, 1024, 1366, 1600, 1920 #}
      {% image "./src/_assets/img/flickr/" + club.image.contentUrl,
      [
        640, 768, 1024, 1366, 1600
      ],
      [
        "avif", "jpeg"
      ],
      club.name,
      "100vw",
      "clubs" %}
    {% endif %}
    <div class="hero-body">
      <div class="container has-text-left">
        <h1 class="title has-background-white is-inline-block has-text-weight-bold {% if club.image or club.owns -%}p-4{% endif %} is-size-2 is-size-3-mobile">{{ club.name }}</h1>
      </div>
    </div>
  </section>
{% endblock %}

{% block actions %}
  <section class="section pt-4 pb-0">
    <div class="level is-mobile container">
      <div class="level-left">
        {% for url in club.sameAs %}
          <div class="level-item">
            {%- set network = url.split("/")[2].split(".")[0] if url.includes("twitter") or url.includes("soundcloud") else url.split("/")[2].split(".")[1] -%}
            {%- set user = url.split("/")[3] -%}
            <a href="{{ url }}" target="_blank" rel="noopener canonical" class="button is-white">
              <span class="icon is-{{ network | lower }}">
                <i class="fab fa-{{ network | lower }}"></i>
              </span>
            </a>
          </div>
        {% endfor %}
        {% if club.url %}
          <div class="level-item is-hidden-mobile">
            <a href="{{ club.url }}/" target="_blank" class="button is-text" rel="noopener">
              <span>{{ club.url.slice(8) }}</span>
              <span class="icon is-small">
                <i class="fas fa-arrow-up-right-from-square is-size-7"></i>
              </span>
            </a>
          </div>
        {% endif %}
      </div>
    </div>
  </section>
{% endblock %}

{% block main %}
  <main class="container">
    <div class="columns is-variable is-8">
      <article class="column is-half">
        <p class="block is-size-5">
          <strong>
            {{- club.alternateName -}}
          </strong>
          {%- if club.keywords %}
          is a {{ club.keywords }}
          {% else %}
           is an 
          {%- endif %}
          {{ club.sport | lower }} club based in {{ club.location.address.addressLocality }}
          {%- if club.location.address.addressRegion -%}
            , {{ club.location.address.addressRegion }}
          {%- endif %}.
        </p>
        <p class="block">
          The club was founded in {{ club.foundingDate }}, and currently plays in the
          <a href="/leagues/{{ club.memberOf.name | slugify }}">{{ club.memberOf.sponsor.name }}
            {{ club.memberOf.name }}</a>, 
            {%- if club.memberOf.additionalProperty %}
            the {{ club.memberOf.additionalProperty.value | ordinal }} tier of 
            the English football league system
            {%- endif %}.
        </p>
        <p class="block">
          {{ club.name }} plays its home matches at 
          <a href="/regions/{{ club.areaServed.name | slugify }}/{{ club.location.name | slugify }}">{{ club.location.name }}</a>,
          a stadium which has a capacity of {{ club.location.maximumAttendeeCapacity | commaNumber }} spectators.
        </p>
        {%- if club.description %}
          {%- for sentence in club.description.split(". ") %}
            <p class="block">
              {{ sentence }}
              {% if not loop.last %}.{% endif %}
            </p>
          {%- endfor %}
        {%- endif %}

        {%- if club.owns.mainEntityOfPage %}
          <p class="block">
            The clubs 
            {% if club.owns.mainEntityOfPage %}
              <a href="{{ club.owns.mainEntityOfPage }}" target="_blank" rel="noopener" class="is-info">home kit</a>
            {% else %}
             home kit
            {% endif %}
            {% if club.owns.material %}is made of {{ club.owns.material }} and {% endif %} 
              is manufactured by <span class="has-text-weight-semibold">{{ club.owns.brand }}</span>.
          </p>
        {%- endif %}

        {% for url in club.sameAs %}
          {% if "youtube" in url %}
            <figure class="image is-16by9 box">
              {% if "channel" in url %}
                {% set channel = url.split("/")[4] %}
                <iframe class="has-ratio" id="youtube" width="600" height="340"></iframe>
              {% endif %}
            </figure>
          {% endif %}
        {% endfor %}

        {%- if club.nonProfitStatus %}
          <hr class="separator"/>
          <p class="block has-text-grey is-size-7">
            {% if club.nonProfitStatus == "UnincorporatedAssociationCharity" %}
              <span class="has-text-weight-semibold">{{ club.alternateName }}</span> 
            is an <a href="https://www.gov.uk/unincorporated-associations">unincorporated association</a>.
          {% elif club.nonProfitStatus == "LimitedByGuaranteeCharity" %}
              <span class="has-text-weight-semibold">{{ club.legalName }}</span> 
            trading as {{ club.alternateName }}
            is a not-for-profit company limited by guarantee. 
            Company number <a href="https://find-and-update.company-information.service.gov.uk/search?q={{ club.identifier.value.slice(7) }}">
                {{ club.identifier.value.slice(7) }}
              </a>.
          {% endif %}
          </p>
        {%- endif %}

        {# 
          {%- if club.legalName %}
            <p class="block has-text-grey">
              <small>
                {%- if club.identifier.propertyID == "Company Number" %}
                  {%- if club.identifier.value.slice(7,9) in ["IP", "RS"] %}
                    <span class="has-text-weight-semibold">{{ club.legalName }}</span> 
                    is a community benefit society, operating under the name of {{ club.alternateName }} 
                    and are regulated by the <a href="https://mutuals.fca.org.uk" rel="nopener" target="_blank">Financial Conduct Authority</a>.
                    The company registration number is {{ club.identifier.value.slice(9) }}
                  {%- else %}
                    <span class="has-text-weight-semibold">{{ club.alternateName }}</span> is a trading name for {{ club.legalName }}, company number 
                      <a href="https://find-and-update.company-information.service.gov.uk/search?q={{ club.identifier.value.slice(7) }}" rel="noopener" target="_blank">{{ club.identifier.value.slice(7) }}</a>
                  {%- endif %}.
                {% else %}
                  {{ club.alternateName }} is a trading name for {{ club.legalName }}.
                {%- endif %}
              </small>
            </p>
          {%- endif %}
        #}
      </article>

      <aside class="column is-one-quarter">
        <div>
          <h4 class="heading">Nickname</h4>
          <p class="block">{{ club.slogan }}</p>
          <h4 class="heading">Founded</h4>
          <p class="block">
            <time datetime="YYYY">{{ club.foundingDate }}</time>
          </p>
          <h4 class="heading">Ground</h4>
          <p class="block">
            <a href="/regions/{{ club.areaServed.name | slugify }}/{{ club.location.name | slugify }}/">
              {{ club.location.name }}
            </a>
          </p>
        </div>
      </aside>
      <aside class="column is-one-quarter">
        {%- if club.image %}
          <h4 class="heading">Photo Credit</h4>
          {{ creativeCommons(club.image)}}
        {% endif %}
      </aside>
    </div>
  </main>

{% endblock %}